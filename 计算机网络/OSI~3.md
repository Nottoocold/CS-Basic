# 1OSI七层参考模型

- 物理层，任务是传输透明的比特流，功能是在物理媒体上为数据端设备透明地传输原始比特流。

- 数据链路层，任务是将网络层传输过来的IP数据组装成帧，功能可以概括为组帧、差错控制、流量控制和传输管理等。典型协议有SDLC、HDLC、PPP、STP和帧中继等。

- 网络层，主要关心通信子网的控制，主要任务是把网络层的协议数据单元从源端传到目的端；为分组交换网上的不同主机提供通信服务。关键是对分组进行路由选择，并实现差错控制、流量控制、拥塞控制和网际互连等功能。典型协议有IP、ICMP、IGMP、ARP、OSPF等。

- 传输层，负责主机间两个进程的通信，功能是为端到端链接提供可靠的传输服务，为端到端连接提供流量控制、差错控制、数据传输管理等服务。

- 会话层，允许不同主机上各个进程之间通信，会话层利用传输层提供的端到端通信，为表示层提供他的增值服务。这种服务主要为表示层实体或用户进程建立连接并在连接上有序地传输数据，则就是会话，也称建立同步。

- 表示层，主要处理在两个通信系统中交换信息的方式，不同主机可能表示信息的方式不同，为了能使无障碍交流，表示层采用抽象的标准方法定义数据结构，并采用标准编码形式。

- 应用层，是用户与网络的界面，应用层为特定类型的网络应用提供访问OSI参考模型环境的手段。协议有DNS、SMTP、HTTP、FTP等。

# TCP\IP模型

- 网络接口层，类似物理层和数据链路层，作用是从主机或节点接收IP分组，并把他们发送到指定的物理网络上。
- 网际层，将分组发往任何网络，并为之选择合适的路由，但不保证各个分组有序到达。
- 传输层，类似与OSI中的传输层。TCP、UDP
- 应用层包含所有的高层协议。

# 数据链路层

在物理层提供的服务的基础上向网络层提供服务，主要作用是加强物理层传输原始比特流的功能，将物理层提供的可能出错的物理连接改造成逻辑上无差错的数据链路，使之对网络层表现为一条无差错的链路。

## 作用：

- 为网络层提供服务
  - 无确认无连接，如以太网
  - 有确认无连接，如无线通信
  - 有确认有连接，适用于通信要求较高的场景
- 链路管理，连接的建立、维持和释放，通常面向有连接服务。
- 帧定界（区分出数据帧的首部尾部和数据部分），帧同步（接收方能够从比特流中区分出帧的起始和结束），透明传输（不管所传输数据是设么比特流组合，都能正确传输）。
- 流量控制，限制发送方的发送速率，使其发送速率不超过接收方的接收能力。在TCP/IP协议栈中，该功能被放到了传输层中。
- 差错控制，位错（CRC、ARQ）和帧错（定时器，帧编号）。

### 流量控制。

- 停止-等待流量控制
- 滑动窗口流量控制，滑动窗口重要特性：只有当接收窗口向前滑动时发送窗口才有可能向前滑动；在传输过程中，窗口大小时固定的。

### 可靠传输机制。

- 通常使用超时和确认重传两种机制。
- 自动重传请求ARQ，传统的有三类：
  - 单帧滑动窗口与停止-等待协议，发送窗口和接收窗口都是1
  - 多帧滑动窗口和后退N帧（GBN），接收方可以累计确认，若采用n比特对帧编号，则其发送窗口尺寸应1<=W<=(2^n)-1，接收窗口为1。
  - 多帧滑动窗口与选择重传（SR），发送窗口和接收窗口大小相等，最大为2^(n-1)。

### 介质访问控制

- 信道划分介质访问控制。一条介质上同事携带多个传输信号的方法来提高传输系统的利用率，此种方式就是所谓的多路复用。常见的有：
  - 频分
  - 时分
  - 波分
  - 码分
- 随机访问介质访问控制，用户根据自己意愿随机发送信息，占用信道全部速率，常见协议有：ALOHA协议、CSMA协议、CSMA/CD、CSMA/CA，它们的核心思想都是：胜利者通过争用获得信道的使用权，本质上将一个广播信道逻辑上变为了点对点信道。
  - 1-坚持CSMA，侦听到信道忙，继续坚持侦听；侦听到信道空闲，则发送信息的概率是1。
  - 非坚持CSMA，侦听到信道忙，放弃继续侦听，而是等待一个随机时间后再侦听；侦听到信道空闲，立即发送数据。
  - p-坚持CSMA，若信道忙，就持续侦听（推迟到下一个时隙再侦听）；若信道空闲，则以概率p发送数据，以概率1-p推迟到下一个时隙；此方案是前两种方案的折中。
  - CSMA/CD，适用于总线型网络和半双工环境。先听后发，边听边发，冲突停发，随机重发。若检测到碰撞，则停止发送，并发送一个拥塞信号，以告知其他站点，在终止发送后，执行指数退避算法，等待一个随机时间后继续进行发送过程。**争用期时间=2*端到端传播时延**，为了在发送数据的同时就能检测到是否发生碰撞，所以就**帧的发送时延至少要等于争用期**。有线局域网。
  - CSMA/CA，由于无线通信信道质量远不如有线信道，802.11局域网使用链路层的ARQ方案(停止-等待协议)，所有站发送完数据后，必须再等待一段很短的时间(继续监听)才能发送下一帧。这段时间称为帧间间隔(IFS)。

二者对比：

- CD可以检测冲突，但无法避免；CA发送数据的同时不能检测
- 传输介质不同，CD适用于总线型以太网；CA用于802.11a/b/g/n等无线局域网。
- 检测方式不同，CD通过电缆中的电压变化来检测；CA采用能量检测、载波检测和能量载波三种方式。
- 总结：CA协议的基本思想是发送数据前先广播告知其他站点，让其他站点在某段时间内不要发送数据，以避免出现碰撞；CD协议的基本思想是发送前先侦听，边发送边侦听，一旦出现碰撞马上停止发送。

# 网络层

功能：

- 异构网络互联
- 路由与转发

路由选择协议：

- 域内路由选择：RIP、OSPF
- 域间路由选择：BGP
