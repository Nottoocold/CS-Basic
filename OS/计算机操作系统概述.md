# 计算机操作系统概述

## 概念

何为操作系统？

- 操作系统指控制和管理整个计算机系统**硬件和软件**资源，合理地组织、调度计算机的工作和资源的分配，进而为用户和其他软件提供方便的接口和环境的程序的集合。操作系统是计算机系统中最基本的系统软件。
  
  ### 操作系统的目标和功能

- 操作系统作为系统资源的管理者
  
  - **处理机管理**，在多道程序环境下，处理机的分配和调度都以进程(线程)为基本单位，因而对处理机的管理就是对进程的管理。
  - **存储器管理**是为了给多道程序的运行提供环境，方便用户使用和提高内存的利用率。
  - **文件管理**，计算机中的信息都是以文件的形式存在，所以操作系统中负责管理文件的一块功能称为文件系统，包括对文件存储空间的管理、目录管理及文件读写管理和保护等。
  - **设备管理**，主要任务是完成用户的IO请求，方便用户使用各种设备，提高设备利用率。

- 操作系统作为用户和硬件之间的接口
  
  - **命令接口**，用户利用操作命令来组织和控制作业的执行。
  - **程序接口(系统调用、广义指令)**，编程人员使用它们来完成程序请求操作系统服务。

- 操作系统实现了对计算机资源的扩充
  
  - 没有安装任何软件的计算机称为裸机。它仅构成了计算机的物质基础，而实际呈现在用户面前的计算机是经过若干层软件抽象的计算机。裸机在最里层，外层是操作系统，操作系统所提供的各种功能，将裸机改造成了功能更强、使用更方便的机器，因此，通常将覆盖了一层软件的机器称为扩充机器或虚拟机。
  
  ### 操作系统的特征

- **并发(Concurrence)**，指一段时间内能够同时发生多个事件，操作系统的并发性指计算机系统中同时存在多个运行的程序，因此操作系统具有同时调度和管理多个程序同时运行的能力。

- **共享(Sharing)**，又可分为互斥共享，指同一时间段内只能有一个进程能够访问某临界资源；同时共享指同一时间段内，在宏观上允许多个进程访问，其微观上其实是交替访问的。

- **虚拟(Virtual)**，是指把一个物理实体变为若干逻辑上的对应物。典型应用有，虚拟处理器技术，虚拟存储器技术，虚拟外部设备等。

- **异步(Asynchronism)**，多道程序并发运行的环境下，由于资源有限，进程的执行并不是一贯到底的，而是断断续续的，以不可预知的进度向前推进，这就是进程的异步特性。
  
  **并发性和共享性是最基本的两个特征，是互为存在条件的。**
  
  **提问库函数和系统调用的区别和联系？**
  
  ​    库函数是语言或应用程序的一部分，可以运行在用户空间中。而系统调用是操作系统的一部分，是系统为用户提供的程序接口，运行在内核空间中，而且许多库函数都会使用系统调用来完成响应功能。未使用系统调用的库函数，执行效率会比系统调用高，因为使用系统调用的话，需要上下文切换以及状态转换(由用户态转为核心态)。

## 操作系统运行环境

### 处理器运行模式

  通常CPU执行两种不同性质的程序：一种是操作系统内核程序；一种是应用程序。前者可以执行一些特权指令，可以管理后者的运行。特权指令如，IO指令，置中断指令，内存相关指令等。而应用程序只能执行非特权指令。CPU运行模式可分为核心态和用户态。
  操作系统的设计通常采用分层设计。和硬件紧密相关的如**时钟管理，中断机制，原语**等处于最底层。往外是一些**进程管理，存储器管理，设备管理**等，这两部分构成了操作系统的内核，这部分的指令工作在核心态。

### 中断和异常

  运行在用户态的应用程序是不能使用核心态功能的，但是应用程序在运行时难免会需要这些功能，所以需要在核心态上建立一些“门”，以便实现从用户态进入核心态。在实际操作系统中，CPU上运行的应用程序能进入这些“门”的**唯一途径**就是通过**中断和异常**，当发生中断或异常时，CPU会立即进入核心态(通过硬件实现)。

- 中断(外中断)，中断信息来自CPU外部，如IO中断，时钟中断。外中断可以被屏蔽。

- 异常(内中断)，中断信号来自CPU内部，指来自CPU执行指令内部的事件，如程序的非法操作码，地址越界，运算溢出，缺页异常，程序执行陷入(trap)指令等，内中断不能被屏蔽，一旦出现就应立即被处理。
  
  - 异常可分为：故障(Fault) 自陷(Trap) 终止(Abort) 